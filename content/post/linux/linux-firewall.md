+++
title = "Linux 下 iptables 常用命令"
date = "2017-11-07"
lastmod = "2017-12-07"
tags = [
    "Linux",
    "iptables"
]
categories = [
    "技术"
]
+++

本篇博客记录了 iptables 常用命令，对于运维人员，会经常需要用到。

<!--more-->

### docker bridge 网络模式防火墙配置
> 以bridge网络模式运行Docker容器需要的防火墙配置
```markdown
*nat
:PREROUTING ACCEPT [27:11935]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [598:57368]
:POSTROUTING ACCEPT [591:57092]
:DOCKER - [0:0]
-A PREROUTING -m addrtype --dst-type LOCAL -j DOCKER
-A OUTPUT ! -d 127.0.0.0/8 -m addrtype --dst-type LOCAL -j DOCKER
-A POSTROUTING -s 172.17.0.0/16 ! -o docker0 -j MASQUERADE #docker网桥的子网
-A POSTROUTING -j MASQUERADE
COMMIT
# Completed on Sun Sep 20 17:35:31 2015
# Generated by iptables-save v1.4.21 on Sun Sep 20 17:35:31 2015
*filter
:INPUT ACCEPT [139291:461018923]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [127386:5251162]
:DOCKER - [0:0]
-A FORWARD -o docker0 -j DOCKER
-A FORWARD -o docker0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -i docker0 ! -o docker0 -j ACCEPT
-A FORWARD -i docker0 -o docker0 -j ACCEPT
COMMIT
```

### 开放防火墙端口

1、开放22端口
```markdown
-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
```

2、开放7000-8000之间的所有端口
```markdown
-A INPUT -p tcp -m state --state NEW -m tcp --dport 7000:8000 -j ACCEPT
```

3、开放7000及其以下的所有端口
```markdown
-A INPUT -p tcp -m state --state NEW -m tcp --dport :7000 -j ACCEPT
```

4、开放8000及其以上的所有端口
```markdown
-A INPUT -p tcp -m state --state NEW -m tcp --dport 8000: -j ACCEPT
```
