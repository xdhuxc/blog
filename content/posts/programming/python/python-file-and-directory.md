+++
title = "Python 中的文件和输入输出流"
date = "2017-09-18"
lastmod = "2017-09-18"
tags = [
    "Python"
]
categories = [
    "技术"
]
+++

本篇博客介绍下 Python 语言中的文件和输入输出流。

<!--more-->

### 文件I/O

基本的的I/O函数

#### 打印到屏幕

最简单的输出方法是用print语句，可以给它传递零个或多个用逗号隔开的表达式。此函数把传递的表达式转换成一个字符串表达式，并将结果写到标准输出。

#### 读取键盘输入

Python提供了两个内置函数从标准输入读入一行文本，默认的标准输入是键盘。如下：

* raw_input
* input

#### raw_input函数

raw_input([prompt]) 函数从标准输入读取一个行，并返回一个字符串（去掉结尾的换行符）：

```markdown
#!/usr/bin/python
# -*- coding: UTF-8 -*- 
 
xdhuxc = raw_input("请输入：");
print "输入的内容是: ", xdhuxc
```

将提示输入任意字符串，然后在屏幕上显示相同的字符串。当输入"Hello Python！"，它的输出如下：
```markdown
请输入：Hello Python！
输入的内容是:  Hello Python！
```

#### input 函数

input([prompt]) 函数和 raw_input([prompt]) 函数基本类似，但是 input 可以接收一个Python表达式作为输入，并将运算结果返回。

```markdown
#!/usr/bin/python
# -*- coding: UTF-8 -*- 
 
xdhuxc = input("请输入：");
print "输入的内容是: ", xdhuxc
```

会产生如下的对应着输入的结果：
```markdown
请输入：[x*5 for x in range(2,10,2)]
输入的内容是:  [10, 20, 30, 40]
```

### 打开和关闭文件

Python 提供了必要的函数和方法进行默认情况下的文件基本操作。可以用 file 对象做大部分的文件操作。

#### open 函数

必须先用Python内置的open()函数打开一个文件，创建一个file对象，相关的方法才可以调用它进行读写。语法：
```markdown
file object = open(file_name [, access_mode][, buffering])
```

各个参数的含义如下：

* file_name：file_name变量是一个包含了你要访问的文件名称的字符串值。
* access_mode：access_mode决定了打开文件的模式：只读，写入，追加等。所有可取值见如下的完全列表。这个参数是非强制的，默认文件访问模式为只读(r)。
* buffering：如果buffering的值被设为0，就不会有寄存。如果buffering的值取1，访问文件时会寄存行。如果将buffering的值设为大于1的整数，表明了这就是的寄存区的缓冲大小。如果取负值，寄存区的缓冲大小则为系统默认。

不同模式打开文件的完全列表：

模式 | 描述
---|---
r  | 以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。
rb | 以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。
r+ | 打开一个文件用于读写。文件指针将会放在文件的开头。
rb+| 以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。
W  | 打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。
wb | 以二进制格式打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。
w+ | 打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。
wb+| 以二进制格式打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。
a  | 打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。
ab | 以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。
a+ | 打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。
ab+| 以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。

### File 对象的属性

一个文件被打开后，你有一个file对象，你可以得到有关该文件的各种信息。

file对象相关的所有属性的列表

属性 | 描述
---|---
file.closed | 返回true如果文件已被关闭，否则返回false
file.mode | 返回被打开文件的访问模式
file.name | 返回文件的名称
file.softspace | 如果用print输出后，必须跟一个空格符，则返回false。否则返回true

#### close() 方法

File 对象的 close()方法刷新缓冲区里任何还没写入的信息，并关闭该文件，这之后便不能再进行写入。

当一个文件对象的引用被重新指定给另一个文件时，Python 会关闭之前的文件。用 close()方法关闭文件是一个很好的习惯。其语法为：
```markdown
fileObject.close()
```
#### 读写文件

file 对象提供了一系列方法，能让文件访问更轻松。使用 `read()` 和 `write()` 方法来读取和写入文件。

#### write()方法

write()方法可将任何字符串写入一个打开的文件。需要重点注意的是，Python字符串可以是二进制数据，而不是仅仅是文字。

write() 方法不会在字符串的结尾添加换行符 `'\n'`，其语法为：
```markdown
fileObject.write(string) # 在这里，被传递的参数是要写入到已打开文件的内容
```

#### read()方法

read()方法从一个打开的文件中读取一个字符串。需要重点注意的是，Python字符串可以是二进制数据，而不是仅仅是文字。其语法为：

```markdown
fileObject.read([count]) # 在这里，被传递的参数是要从已打开文件中读取的字节计数。该方法从文件的开头开始读入，如果没有传入count，它会尝试尽可能多地读取更多的内容，很可能是直到文件的末尾。
```

#### 重命名和删除文件

Python 的 os 模块提供了执行文件处理操作的方法，比如重命名和删除文件。

要使用这个模块，你必须先导入它，然后才可以调用相关的各种功能

rename()方法需要两个参数，当前的文件名和新文件名。其语法格式为：
```markdown
os.rename(current_file_name, new_file_name)
```

可以用remove()方法删除文件，需要提供要删除的文件名作为参数。其语法格式为：
```markdown
os.remove(file_name)
```

### 目录

所有文件都包含在各个不同的目录下，不过 Python 也能轻松处理。os 模块有许多方法能帮你创建，删除和更改目录。

可以使用 os 模块的 mkdir() 方法在当前目录下创建新的目录。需要提供一个包含了要创建的目录名称的参数。其语法格式为：
```markdown
os.mkdir("new_directory_name")
```

可以用 chdir() 方法来改变当前的目录。chdir() 方法需要的一个参数是你想设成当前目录的目录名称。其语法格式为：
```markdown
os.chdir("new_directory_name")
```

getcwd() 方法显示当前的工作目录。其语法格式为：
```markdown
os.getcwd()
```

rmdir() 方法删除目录，目录名称以参数传递。在删除这个目录之前，它的所有内容应该先被清除。其语法格式为：
```markdown
os.rmdir("directory_name")
``` 
目录的完全合规的名称必须被给出，否则会在当前目录下搜索该目录。


